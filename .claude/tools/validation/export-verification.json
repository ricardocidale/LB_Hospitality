{
  "name": "export_verification",
  "description": "Verify that exported files (Excel, PDF, PowerPoint, CSV, PNG) contain all expected sections and that key financial values match the on-screen data. Supports the checker manual Phase 6 (Reports & Exports Completeness). Checks section presence, value accuracy for sampled cells, formatting consistency, and metadata correctness.",
  "input_schema": {
    "type": "object",
    "properties": {
      "export_format": {
        "type": "string",
        "enum": ["excel", "pdf", "pptx", "csv", "png_chart", "png_table"],
        "description": "Format of the export being verified"
      },
      "export_source": {
        "type": "string",
        "enum": ["income_statement", "cash_flow", "balance_sheet", "investment_analysis", "dashboard", "company_financials", "consolidated"],
        "description": "Which financial view was exported"
      },
      "expected_sections": {
        "type": "array",
        "items": { "type": "string" },
        "description": "List of section names/headers expected in the export (e.g. 'Revenue', 'Operating Expenses', 'Net Income')"
      },
      "sample_values": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "label": { "type": "string", "description": "Row/field label (e.g. 'Total Revenue Year 1')" },
            "expected_value": { "type": "number", "description": "Value shown on screen" },
            "exported_value": { "type": "number", "description": "Value found in export" },
            "tolerance": { "type": "number", "default": 1.0 }
          },
          "required": ["label", "expected_value", "exported_value"]
        },
        "description": "Spot-check values to verify export matches screen"
      },
      "expected_year_count": {
        "type": "integer",
        "description": "Expected number of projection years/columns in the export"
      },
      "expected_property_count": {
        "type": "integer",
        "description": "Expected number of properties included (for consolidated exports)"
      }
    },
    "required": ["export_format", "export_source"]
  },
  "output_schema": {
    "type": "object",
    "properties": {
      "all_passed": { "type": "boolean" },
      "checks": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "check": { "type": "string" },
            "passed": { "type": "boolean" },
            "details": { "type": "string" }
          }
        }
      },
      "missing_sections": {
        "type": "array",
        "items": { "type": "string" }
      },
      "value_mismatches": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "label": { "type": "string" },
            "expected": { "type": "number" },
            "actual": { "type": "number" },
            "variance": { "type": "number" }
          }
        }
      }
    }
  }
}

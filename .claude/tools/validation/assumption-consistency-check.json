{
  "name": "assumption_consistency_check",
  "description": "Scan global and property-level assumptions for missing values, out-of-range inputs, contradictions, and logical inconsistencies before financial calculations run. Catches common errors like: refinance date before acquisition, exit cap rate of 0%, occupancy > 100%, negative cost rates, operations start before model start, missing SAFE funding dates when company has expenses.",
  "input_schema": {
    "type": "object",
    "properties": {
      "global_assumptions": {
        "type": "object",
        "properties": {
          "model_start_date": { "type": "string" },
          "projection_years": { "type": "integer" },
          "company_ops_start_date": { "type": "string" },
          "inflation_rate": { "type": "number" },
          "fixed_cost_escalation_rate": { "type": "number" },
          "base_management_fee": { "type": "number" },
          "incentive_management_fee": { "type": "number" },
          "safe_tranche1_date": { "type": "string" },
          "safe_tranche1_amount": { "type": "number" },
          "safe_tranche2_date": { "type": "string" },
          "safe_tranche2_amount": { "type": "number" },
          "exit_cap_rate": { "type": "number" },
          "debt_assumptions": {
            "type": "object",
            "properties": {
              "interest_rate": { "type": "number" },
              "amortization_years": { "type": "integer" },
              "acq_ltv": { "type": "number" },
              "refi_ltv": { "type": "number" }
            }
          }
        },
        "required": ["model_start_date"]
      },
      "properties": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "name": { "type": "string" },
            "operations_start_date": { "type": "string" },
            "acquisition_date": { "type": "string" },
            "purchase_price": { "type": "number" },
            "room_count": { "type": "integer" },
            "start_adr": { "type": "number" },
            "start_occupancy": { "type": "number" },
            "max_occupancy": { "type": "number" },
            "type": { "type": "string" },
            "will_refinance": { "type": "string" },
            "refinance_date": { "type": "string" },
            "exit_cap_rate": { "type": "number" },
            "land_value_percent": { "type": "number" }
          },
          "required": ["name", "operations_start_date", "purchase_price"]
        }
      }
    },
    "required": ["global_assumptions"]
  },
  "output_schema": {
    "type": "object",
    "properties": {
      "is_valid": { "type": "boolean", "description": "True if no critical or material issues found" },
      "total_issues": { "type": "integer" },
      "issues": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "severity": { "type": "string", "enum": ["critical", "material", "warning", "info"] },
            "category": { "type": "string", "enum": ["missing_value", "out_of_range", "contradiction", "timing_conflict", "business_rule"] },
            "entity": { "type": "string", "description": "Which entity is affected (global, property name)" },
            "field": { "type": "string", "description": "Assumption field name" },
            "message": { "type": "string", "description": "Human-readable description of the issue" },
            "current_value": { "type": "string", "description": "Current value (or 'missing')" },
            "expected_range": { "type": "string", "description": "Acceptable range or constraint" }
          }
        }
      },
      "summary_by_severity": {
        "type": "object",
        "properties": {
          "critical": { "type": "integer" },
          "material": { "type": "integer" },
          "warning": { "type": "integer" },
          "info": { "type": "integer" }
        }
      }
    }
  }
}
